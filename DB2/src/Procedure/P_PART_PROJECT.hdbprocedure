PROCEDURE "P_PART_PROJECT"( 
		OUT ET_SORT_DATA TABLE  ("ID" INTEGER,
								 "PROJECT" INTEGER,
								 "NEXT_TASK" INTEGER
								 )
	) 
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   --DEFAULT SCHEMA <default_schema_name>
   READS SQL DATA AS
BEGIN
	ET_SORT_DATA =  SELECT "ID",
							"PROJECT",
							 LAG("ID") OVER (PARTITION BY "PROJECT" 
										ORDER BY "ID" ) AS "NEXT_TASK"
					FROM "TASKS"
					ORDER BY "ID";
					
END;